{"paragraphs":[{"title":"Выполнение","text":"%md\n\n* Скопировать тетрадку в тетрадку it_3/<логин>/1 hw\n(Кнопка скопировать пятая в верхнем ряду)\n\n* Дополнить параграфы своим кодом, чтобы получился аналогичный вывод параграфов\n\n* Прислать ссылку на решение преподавателю в телеграм","user":"admin","dateUpdated":"2021-12-07T19:40:14+0300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<ul>\n  <li>\n  <p>Скопировать тетрадку в тетрадку it_3/&lt;логин&gt;/1 hw<br/>(Кнопка скопировать пятая в верхнем ряду)</p></li>\n  <li>\n  <p>Дополнить параграфы своим кодом, чтобы получился аналогичный вывод параграфов</p></li>\n  <li>\n  <p>Прислать ссылку на решение преподавателю в телеграм</p></li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1637069616412_-1808116712","id":"20211115-182905_654876257","dateCreated":"2021-11-16T16:33:36+0300","dateStarted":"2021-11-18T08:23:13+0300","dateFinished":"2021-11-18T08:23:13+0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:107"},{"text":"%pyspark\nimport pyspark.sql.functions as f\n\n# read data\nevents_df = spark.table(\"market.events\")\n\n# display data\nevents_df.show(100)\n","user":"smykov","dateUpdated":"2021-11-18T21:23:33+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637069944548_-1045778266","id":"20211116-163904_897332829","dateCreated":"2021-11-16T16:39:04+0300","dateStarted":"2021-11-18T21:23:33+0300","dateFinished":"2021-11-18T08:24:00+0300","status":"ABORT","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:108"},{"title":"Вывести топ категорий по количеству просмотров товаров за всё время","text":"%pyspark\nimport pyspark.sql.functions as f\n\nevents_df \\\n    .where(\"event_type = 'view'\") \\\n    .groupBy(\"category_code\") \\\n    .agg(\n        f.count(\"*\").alias(\"total_views\")\n        ) \\\n    .orderBy(f.col(\"total_views\").desc()) \\\n    .show(truncate=False)\n","user":"admin","dateUpdated":"2021-11-16T18:27:31+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------------------+-----------+\n|category_code                   |total_views|\n+--------------------------------+-----------+\n|null                            |20837460   |\n|electronics.smartphone          |14832387   |\n|computers.notebook              |2103024    |\n|electronics.video.tv            |2071305    |\n|electronics.clocks              |1994440    |\n|apparel.shoes                   |1836676    |\n|electronics.audio.headphone     |1644910    |\n|appliances.environment.vacuum   |1445029    |\n|appliances.kitchen.refrigerators|1362018    |\n|appliances.kitchen.washer       |1313807    |\n|computers.desktop               |673875     |\n|furniture.living_room.cabinet   |539983     |\n|furniture.bedroom.bed           |519487     |\n|apparel.shoes.keds              |475966     |\n|electronics.tablet              |464073     |\n|auto.accessories.player         |456658     |\n|furniture.living_room.sofa      |417428     |\n|construction.tools.drill        |381287     |\n|appliances.kitchen.oven         |362455     |\n|kids.carriage                   |336311     |\n+--------------------------------+-----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637069616412_759459511","id":"20211115-180448_92621901","dateCreated":"2021-11-16T16:33:36+0300","dateStarted":"2021-11-18T08:24:00+0300","dateFinished":"2021-11-18T08:24:09+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:109"},{"text":"%pyspark\n\nevents_df \\\n    .where(\"date == '2019-11-10'\") \\\n    .where(\"event_type == 'purchase'\") \\\n    .show(truncate=False)","user":"admin","dateUpdated":"2021-11-16T18:27:36+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------------+----------+----------+-------------------+--------------------------------+--------+-------+---------+------------------------------------+----------+\n|event_time             |event_type|product_id|category_id        |category_code                   |brand   |price  |user_id  |user_session                        |date      |\n+-----------------------+----------+----------+-------------------+--------------------------------+--------+-------+---------+------------------------------------+----------+\n|2019-11-10 00:00:00 UTC|purchase  |3600937   |2053013563810775923|appliances.kitchen.washer       |samsung |334.6  |533074223|c74583ca-5af8-4fa6-9c5f-ff66c9047ad2|2019-11-10|\n|2019-11-10 00:01:24 UTC|purchase  |1005122   |2053013555631882655|electronics.smartphone          |apple   |1023.62|546881736|e1d94657-cbe1-423c-b78c-eb3541cfdc30|2019-11-10|\n|2019-11-10 00:01:24 UTC|purchase  |5100689   |2053013553341792533|electronics.clocks              |apple   |326.88 |536649695|d7787301-3490-4cdd-8b70-77f57935b604|2019-11-10|\n|2019-11-10 00:01:51 UTC|purchase  |12701293  |2053013553559896355|null                            |triangle|50.19  |547307579|9d0c0099-10ea-488a-b833-56318e3bff7f|2019-11-10|\n|2019-11-10 00:03:12 UTC|purchase  |26027151  |2053013562837697343|null                            |null    |9.01   |568813035|0a59b3cf-0a55-4021-9b1f-7aae615acfc0|2019-11-10|\n|2019-11-10 00:03:36 UTC|purchase  |1801712   |2053013554415534427|electronics.video.tv            |lg      |383.28 |560403902|4ab17cc8-0744-4544-82e4-7a241ae7c3a1|2019-11-10|\n|2019-11-10 00:03:36 UTC|purchase  |2701657   |2053013563911439225|appliances.kitchen.refrigerators|beko    |233.54 |569513017|77d54fed-89a4-404c-9ca7-f16e3dd02d68|2019-11-10|\n|2019-11-10 00:04:47 UTC|purchase  |17500025  |2053013558752445019|null                            |finish  |39.1   |512432515|334d0b50-c768-4577-8c70-4a21763c3bc8|2019-11-10|\n|2019-11-10 00:07:04 UTC|purchase  |1005116   |2053013555631882655|electronics.smartphone          |apple   |980.17 |520510220|1fefe112-1f1a-4a3f-a176-900b5be9e878|2019-11-10|\n|2019-11-10 00:08:24 UTC|purchase  |4804056   |2053013554658804075|electronics.audio.headphone     |apple   |159.84 |565665319|c0d4f48c-f0da-43cb-8591-95719442fa07|2019-11-10|\n|2019-11-10 00:08:54 UTC|purchase  |1002633   |2053013555631882655|electronics.smartphone          |apple   |378.39 |513271712|9212568b-1601-47f0-95e3-82198597b1e0|2019-11-10|\n|2019-11-10 00:09:37 UTC|purchase  |1005186   |2053013555631882655|electronics.smartphone          |samsung |771.94 |567343348|c3992f69-ee9c-47bd-ac66-dab55a9be578|2019-11-10|\n|2019-11-10 00:11:45 UTC|purchase  |3500093   |2053013555287949705|null                            |null    |33.46  |560106418|e669370d-afb5-451a-bd2f-6ca23e40eb2d|2019-11-10|\n|2019-11-10 00:12:50 UTC|purchase  |1003312   |2053013555631882655|electronics.smartphone          |apple   |746.22 |512661473|10328991-9b1f-433f-a9de-7a9f44a194eb|2019-11-10|\n|2019-11-10 00:13:12 UTC|purchase  |1004249   |2053013555631882655|electronics.smartphone          |apple   |739.79 |513271712|9212568b-1601-47f0-95e3-82198597b1e0|2019-11-10|\n|2019-11-10 00:13:40 UTC|purchase  |1005160   |2053013555631882655|electronics.smartphone          |xiaomi  |204.73 |547728207|2766188c-c066-4754-aad9-54cdb18f7091|2019-11-10|\n|2019-11-10 00:15:06 UTC|purchase  |1005160   |2053013555631882655|electronics.smartphone          |xiaomi  |204.73 |547728207|2766188c-c066-4754-aad9-54cdb18f7091|2019-11-10|\n|2019-11-10 00:15:21 UTC|purchase  |28719165  |2053013565228450757|apparel.shoes                   |rieker  |86.23  |517291462|a3ce06f7-77d0-4c08-8db0-8d87bd9ce8ea|2019-11-10|\n|2019-11-10 00:15:23 UTC|purchase  |1005160   |2053013555631882655|electronics.smartphone          |xiaomi  |204.73 |513271712|9212568b-1601-47f0-95e3-82198597b1e0|2019-11-10|\n|2019-11-10 00:15:34 UTC|purchase  |1002633   |2053013555631882655|electronics.smartphone          |apple   |378.39 |568747045|834a048f-cf28-42f3-903c-871b5d068582|2019-11-10|\n+-----------------------+----------+----------+-------------------+--------------------------------+--------+-------+---------+------------------------------------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637070090401_802016993","id":"20211116-164130_1082832542","dateCreated":"2021-11-16T16:41:30+0300","dateStarted":"2021-11-18T08:24:09+0300","dateFinished":"2021-11-18T08:24:09+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:110"},{"title":"Построить гистограмму распределения цен на проданные товары за 10 ноября 2019 года","text":"%pyspark\nimport pyspark.sql.functions as f\n\nz.show(\n    events_df \\\n    .where(\"date == '2019-11-10'\") \\\n    .where(\"event_type == 'purchase'\") \\\n    .withColumn(\"price_bins\", f.expr(\"ceil(events.price/10) * 10\")) \\\n        .groupBy(\"price_bins\") \\\n        .agg(f.countDistinct(\"product_id\").alias(\"products_amount\"))  #.count()\n)\n\n\n# значение на графике - верхняя граница, т.е. 10 - это от 0 до 10 (не включительно), 50 - от 40 до 50 (не включительно и т.д)","user":"admin","dateUpdated":"2021-12-12T18:10:27+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"price_bins":"string","count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"price_bins","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"products_amount","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"price_bins\tproducts_amount\n2040\t2\n1010\t6\n1360\t2\n270\t39\n730\t13\n2570\t2\n1690\t1\n720\t1\n330\t27\n530\t5\n1640\t1\n130\t168\n830\t9\n1460\t1\n1200\t2\n570\t26\n50\t448\n600\t16\n1210\t3\n1110\t2\n650\t16\n110\t187\n190\t69\n1240\t3\n420\t32\n1550\t4\n970\t5\n1420\t4\n1940\t3\n1440\t1\n450\t7\n990\t3\n700\t11\n1530\t1\n880\t6\n2110\t1\n2550\t1\n1330\t1\n1810\t1\n820\t5\n760\t1\n370\t33\n790\t2\n320\t18\n1150\t1\n920\t2\n1570\t2\n610\t10\n150\t105\n1800\t1\n170\t98\n1060\t5\n1190\t4\n430\t22\n1100\t5\n900\t3\n1700\t1\n1040\t1\n250\t49\n1560\t1\n2390\t1\n1130\t1\n120\t165\n10\t253\n500\t15\n550\t14\n490\t22\n2010\t3\n1000\t3\n460\t15\n950\t4\n100\t215\n850\t7\n800\t5\n540\t10\n210\t74\n590\t5\n220\t68\n940\t2\n580\t7\n440\t31\n1340\t4\n160\t140\n2580\t3\n1900\t3\n1090\t3\n1430\t1\n200\t78\n390\t39\n280\t37\n1910\t2\n910\t14\n710\t5\n480\t14\n1510\t1\n290\t52\n560\t12\n260\t72\n740\t3\n80\t279\n380\t35\n750\t12\n400\t29\n520\t31\n1350\t1\n360\t31\n1720\t1\n2160\t1\n230\t53\n1670\t2\n930\t7\n1380\t1\n1160\t4\n1600\t4\n2450\t1\n1370\t3\n780\t13\n140\t105\n410\t17\n1290\t5\n1300\t2\n670\t8\n1070\t1\n860\t1\n1170\t2\n840\t1\n620\t14\n1470\t2\n960\t7\n310\t45\n1030\t13\n1320\t4\n180\t110\n350\t31\n1220\t1\n1500\t1\n470\t36\n980\t5\n1630\t2\n30\t348\n1180\t1\n90\t249\n690\t4\n680\t4\n1660\t1\n20\t320\n70\t324\n2340\t1\n1680\t1\n300\t38\n630\t6\n510\t16\n1140\t1\n1610\t1\n640\t7\n1450\t2\n660\t4\n770\t2\n60\t351\n1260\t1\n40\t423\n240\t69\n340\t46\n"},{"type":"TEXT","data":"\n"}]},"apps":[],"jobName":"paragraph_1637069616413_1125130774","id":"20211115-180448_305921057","dateCreated":"2021-11-16T16:33:36+0300","dateStarted":"2021-11-18T08:24:10+0300","dateFinished":"2021-11-18T08:24:14+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"%pyspark\n\n# PROVERKA\nevents_df \\\n    .where(\"date == '2019-11-10'\") \\\n    .where(\"event_type == 'purchase'\") \\\n    .where(\"price >= 1330\").where(\"price < 1340\") \\\n    .agg(\n        f.count(\"*\").alias(\"total_rows\")\n        ) \\\n    .show()\n\n# RAW DATA TEST\n\nevents_df \\\n    .where(\"date == '2019-11-10'\") \\\n    .where(\"event_type == 'purchase'\") \\\n    .where(\"price >= 1330\").where(\"price < 1340\") \\\n    .withColumn(\"price_bins_round\", f.expr(\"round(events.price/10, 0) * 10\")) \\\n    .withColumn(\"price_bins_ceil\", f.expr(\"ceil(events.price/10) * 10\")) \\\n    .show(truncate=False)\n    \n# раунд округляет по правилу HALF_UP что нам не подходит, поэтому берём ceil\n","user":"admin","dateUpdated":"2021-11-17T11:57:11+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+\n|total_rows|\n+----------+\n|       259|\n+----------+\n\n+-----------------------+----------+----------+-------------------+----------------------+-----+-------+---------+------------------------------------+----------+----------------+---------------+\n|event_time             |event_type|product_id|category_id        |category_code         |brand|price  |user_id  |user_session                        |date      |price_bins_round|price_bins_ceil|\n+-----------------------+----------+----------+-------------------+----------------------+-----+-------+---------+------------------------------------+----------+----------------+---------------+\n|2019-11-10 00:47:31 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569516640|70de5e5c-dc14-405c-be65-c94bb6fdb949|2019-11-10|1330.0          |1340           |\n|2019-11-10 01:17:07 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|542055074|18846fa2-0bf7-42ae-b74f-d404977254c0|2019-11-10|1330.0          |1340           |\n|2019-11-10 01:48:10 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|540680454|70c190d2-fb63-47b7-87a0-fe47f8c5fdff|2019-11-10|1330.0          |1340           |\n|2019-11-10 02:06:33 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|566591589|ab6dbe4c-3f60-4729-a4dd-7c05ffb63719|2019-11-10|1330.0          |1340           |\n|2019-11-10 02:38:47 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|514774255|0ad73893-0444-48b5-8ace-80d3b2eee9a9|2019-11-10|1330.0          |1340           |\n|2019-11-10 02:39:55 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569532287|e29edd9f-956c-4b4b-bf49-8cfe39dd170b|2019-11-10|1330.0          |1340           |\n|2019-11-10 02:46:26 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569532287|5d729a76-d428-4e2b-83a1-6e73d6d0485f|2019-11-10|1330.0          |1340           |\n|2019-11-10 03:01:36 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|513777923|bb23ac1d-15d6-4c24-950d-7f21a1967dfc|2019-11-10|1330.0          |1340           |\n|2019-11-10 03:06:20 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|530830583|5a8a1b49-a8a9-40f1-b72f-2a2da5f99e56|2019-11-10|1330.0          |1340           |\n|2019-11-10 03:20:28 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|522342717|b7cd6f1b-eca2-4757-b2c7-128ff253414b|2019-11-10|1330.0          |1340           |\n|2019-11-10 03:25:11 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|516675926|3f11e84b-ced2-46d4-8850-2717aceed6e3|2019-11-10|1330.0          |1340           |\n|2019-11-10 03:40:47 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|516079392|aafa78d5-c24d-42c0-ab99-4d4168fa13a0|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:10:35 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|519061618|f86d1413-541a-446c-a7b4-04fc24600125|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:20:56 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569532287|a2b7ba94-bd3e-4d45-9407-c244a09c9fa5|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:26:44 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569532287|c45a3e9f-206c-407c-a181-ece84e9b6e36|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:27:15 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|553373996|e4eb5d40-0532-4cb9-b6f3-0620f6d0e41f|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:28:43 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|536658266|ff6dc9ef-4ee3-4f0e-8af4-457ad467859f|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:31:30 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569532287|c45a3e9f-206c-407c-a181-ece84e9b6e36|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:31:42 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|569550895|19705d1c-9ab0-4c2d-8398-c6da822217d5|2019-11-10|1330.0          |1340           |\n|2019-11-10 04:32:13 UTC|purchase  |1005105   |2053013555631882655|electronics.smartphone|apple|1332.85|521388778|e39ff606-706a-46fb-b116-cafb18e4dbd8|2019-11-10|1330.0          |1340           |\n+-----------------------+----------+----------+-------------------+----------------------+-----+-------+---------+------------------------------------+----------+----------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637071467463_-1978004813","id":"20211116-170427_810519869","dateCreated":"2021-11-16T17:04:27+0300","dateStarted":"2021-11-18T08:24:14+0300","dateFinished":"2021-11-18T08:24:16+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"user":"smykov","dateUpdated":"2021-11-16T18:27:38+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637069616414_-1160533550","id":"20211115-180448_1076300689","dateCreated":"2021-11-16T16:33:36+0300","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113"}],"name":"it_3/smykov/1 hw 1","id":"2GP4RTAWS","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark::2GP4RTAWS":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}