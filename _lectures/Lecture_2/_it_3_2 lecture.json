{"paragraphs":[{"title":"Задание схемы DataFrame","text":"%pyspark\n\nschema = \"`Id` INT, `First` STRING, `Last` STRING, `Url` STRING, `Published` STRING, `Hits` INT, `Campaigns` ARRAY<STRING>\"\n\n# Create our static data\ndata = [\n    [1, \"Jules\", \"Damji\", \"https://tinyurl.1\", \"1/4/2016\", 4535, [\"twitter\",\"LinkedIn\"]],\n    [2, \"Brooke\",\"Wenig\", \"https://tinyurl.2\", \"5/5/2018\", 8908, [\"twitter\", \"LinkedIn\"]],\n    [3, \"Denny\", \"Lee\", \"https://tinyurl.3\", \"6/7/2019\", 7659, [\"web\", \"twitter\", \"FB\", \"LinkedIn\"]],\n    [4, \"Tathagata\", \"Das\", \"https://tinyurl.4\", \"5/12/2018\", 10568, [\"twitter\", \"FB\"]],\n    [5, \"Matei\",\"Zaharia\", \"https://tinyurl.5\", \"5/14/2014\", 40578, [\"web\", \"twitter\", \"FB\", \"LinkedIn\"]],\n    [6, \"Reynold\", \"Xin\", \"https://tinyurl.6\", \"3/2/2015\", 25568, [\"twitter\", \"LinkedIn\"]]\n]\n\n# Create a DataFrame using the schema defined above\nblogs_df = spark.createDataFrame(data=data, schema=schema)\n# Show the DataFrame; it should reflect our table above\nblogs_df.show()\n# Print the schema used by Spark to process the DataFrame\nprint(blogs_df.printSchema())\n","user":"admin","dateUpdated":"2021-11-18T21:10:22+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---------+-------+-----------------+---------+-----+--------------------+\n| Id|    First|   Last|              Url|Published| Hits|           Campaigns|\n+---+---------+-------+-----------------+---------+-----+--------------------+\n|  1|    Jules|  Damji|https://tinyurl.1| 1/4/2016| 4535| [twitter, LinkedIn]|\n|  2|   Brooke|  Wenig|https://tinyurl.2| 5/5/2018| 8908| [twitter, LinkedIn]|\n|  3|    Denny|    Lee|https://tinyurl.3| 6/7/2019| 7659|[web, twitter, FB...|\n|  4|Tathagata|    Das|https://tinyurl.4|5/12/2018|10568|       [twitter, FB]|\n|  5|    Matei|Zaharia|https://tinyurl.5|5/14/2014|40578|[web, twitter, FB...|\n|  6|  Reynold|    Xin|https://tinyurl.6| 3/2/2015|25568| [twitter, LinkedIn]|\n+---+---------+-------+-----------------+---------+-----+--------------------+\n\nroot\n |-- Id: integer (nullable = true)\n |-- First: string (nullable = true)\n |-- Last: string (nullable = true)\n |-- Url: string (nullable = true)\n |-- Published: string (nullable = true)\n |-- Hits: integer (nullable = true)\n |-- Campaigns: array (nullable = true)\n |    |-- element: string (containsNull = true)\n\nNone\n"}]},"apps":[],"jobName":"paragraph_1637237189814_1359747444","id":"20201119-160217_137855542","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T18:40:05+0300","dateFinished":"2021-11-18T18:40:06+0300","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5704"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import col, sum\n\nblogs_df\\\n.selectExpr(\"*\" , \"concat(first, ' ', last) full_name\")\\\n.agg(sum(col(\"Hits\")).alias(\"Hits\"))\\\n.show()","user":"admin","dateUpdated":"2021-11-18T16:46:04+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+\n| Hits|\n+-----+\n|97816|\n+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189816_250226253","id":"20201123-173223_725419356","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T16:46:04+0300","dateFinished":"2021-11-18T16:46:05+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5705"},{"text":"%pyspark\n\nevents_df = spark.table(\"market.events\")\n\ngrouped = events_df.groupBy(\"brand\").agg(f.count(\"*\")) ","user":"admin","dateUpdated":"2021-11-18T20:25:35+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1637256261553_-219032132","id":"20211118-202421_1083511659","dateCreated":"2021-11-18T20:24:21+0300","dateStarted":"2021-11-18T20:25:35+0300","dateFinished":"2021-11-18T20:25:35+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5706"},{"text":"%pyspark\n\ngrouped.show()","user":"admin","dateUpdated":"2021-11-18T20:27:02+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------+\n|               brand|count(1)|\n+--------------------+--------+\n|            yokohama|  128697|\n|             tuffoni|    3617|\n|             serebro|    7105|\n|             edifier|    3565|\n|               welss|    4929|\n|                tmnt|     574|\n|               lykan|      20|\n|                tega|    2317|\n|               crest|     325|\n|maximumpowernutri...|       2|\n| receptybabuskiagafi|      22|\n|             blaster|     122|\n|              vortex|      55|\n|      houseofseasons|    1318|\n|                dvin|      76|\n|              muimui|       5|\n|         riminibosco|       5|\n|              rosato|     698|\n|              alutec|    2587|\n|               sonel|   11501|\n+--------------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637256340517_1845572235","id":"20211118-202540_1503406875","dateCreated":"2021-11-18T20:25:40+0300","dateStarted":"2021-11-18T20:27:02+0300","dateFinished":"2021-11-18T20:27:20+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5707"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import expr\n\nblogs_df\\\n.where(\"hits > 10000\")\\\n.show()\n","user":"admin","dateUpdated":"2021-11-18T16:46:10+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---------+-------+-----------------+---------+-----+--------------------+\n| Id|    First|   Last|              Url|Published| Hits|           Campaigns|\n+---+---------+-------+-----------------+---------+-----+--------------------+\n|  4|Tathagata|    Das|https://tinyurl.4|5/12/2018|10568|       [twitter, FB]|\n|  5|    Matei|Zaharia|https://tinyurl.5|5/14/2014|40578|[web, twitter, FB...|\n|  6|  Reynold|    Xin|https://tinyurl.6| 3/2/2015|25568| [twitter, LinkedIn]|\n+---+---------+-------+-----------------+---------+-----+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189817_-674314104","id":"20201221-174427_1467084676","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T16:46:10+0300","dateFinished":"2021-11-18T16:46:10+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5708"},{"text":"\nsc.applicationId","user":"admin","dateUpdated":"2021-11-18T15:07:16+0300","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res9: String = application_1605775743750_0010\n"}]},"apps":[],"jobName":"paragraph_1637237189817_-1062299450","id":"20201123-173916_919198115","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5709"},{"text":"%md \n\nWhat were all the different types of fire calls in 2018?\nWhat months within the year 2018 saw the highest number of fire calls?\nWhich neighborhood in San Francisco generated the most fire calls in 2018?\nWhich neighborhoods had the worst response times to fire calls in 2018?\nWhich week in the year in 2018 had the most fire calls?\nIs there a correlation between neighborhood, zip code, and number of fire calls?\nHow can we use Parquet files or SQL tables to store this data and read it back?\n","user":"admin","dateUpdated":"2021-11-18T15:06:29+0300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<p>What were all the different types of fire calls in 2018?\n<br  />What months within the year 2018 saw the highest number of fire calls?\n<br  />Which neighborhood in San Francisco generated the most fire calls in 2018?\n<br  />Which neighborhoods had the worst response times to fire calls in 2018?\n<br  />Which week in the year in 2018 had the most fire calls?\n<br  />Is there a correlation between neighborhood, zip code, and number of fire calls?\n<br  />How can we use Parquet files or SQL tables to store this data and read it back?</p>\n"}]},"apps":[],"jobName":"paragraph_1637237189821_-791571779","id":"20201123-153356_556210607","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5710"},{"text":"%sh\n\ncurl http://37.139.43.86/sf-fire-calls > sf-fire-calls.csv\n\nhdfs dfs -put sf-fire-calls.csv data","user":"admin","dateUpdated":"2021-11-18T16:49:47+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r 36 42.4M   36 15.3M    0     0  74.1M      0 --:--:-- --:--:-- --:--:-- 73.9M\r100 42.4M  100 42.4M    0     0  95.0M      0 --:--:-- --:--:-- --:--:-- 95.0M\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\n"}]},"apps":[],"jobName":"paragraph_1637243352140_1082659698","id":"20211118-164912_819646230","dateCreated":"2021-11-18T16:49:12+0300","dateStarted":"2021-11-18T16:49:47+0300","dateFinished":"2021-11-18T16:49:53+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5711"},{"text":"%sparkLocal.pyspark\n\nspark.read.option(\"header\", True).option(\"inferSchema\", True).csv(\"data/sf-fire-calls.csv\") \\\n.write.parquet(\"data/sf-fire-calls.parquet\")","user":"admin","dateUpdated":"2021-11-18T16:52:52+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1637243407426_779526570","id":"20211118-165007_2100309466","dateCreated":"2021-11-18T16:50:07+0300","dateStarted":"2021-11-18T16:52:52+0300","dateFinished":"2021-11-18T16:52:55+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5712"},{"text":"%pyspark\n\nfireDF = spark.read.option(\"header\", True).load(\"data/sf-fire-calls.parquet\")\nfireDF.printSchema()\nfireDF.show(100, False)\n","user":"admin","dateUpdated":"2021-11-18T16:54:48+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"State":"string","Color":"string","Count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- CallNumber: integer (nullable = true)\n |-- UnitID: string (nullable = true)\n |-- IncidentNumber: integer (nullable = true)\n |-- CallType: string (nullable = true)\n |-- CallDate: string (nullable = true)\n |-- WatchDate: string (nullable = true)\n |-- CallFinalDisposition: string (nullable = true)\n |-- AvailableDtTm: string (nullable = true)\n |-- Address: string (nullable = true)\n |-- City: string (nullable = true)\n |-- Zipcode: integer (nullable = true)\n |-- Battalion: string (nullable = true)\n |-- StationArea: string (nullable = true)\n |-- Box: string (nullable = true)\n |-- OriginalPriority: string (nullable = true)\n |-- Priority: string (nullable = true)\n |-- FinalPriority: integer (nullable = true)\n |-- ALSUnit: boolean (nullable = true)\n |-- CallTypeGroup: string (nullable = true)\n |-- NumAlarms: integer (nullable = true)\n |-- UnitType: string (nullable = true)\n |-- UnitSequenceInCallDispatch: integer (nullable = true)\n |-- FirePreventionDistrict: string (nullable = true)\n |-- SupervisorDistrict: string (nullable = true)\n |-- Neighborhood: string (nullable = true)\n |-- Location: string (nullable = true)\n |-- RowID: string (nullable = true)\n |-- Delay: double (nullable = true)\n\n+----------+------+--------------+-------------------------------+----------+----------+--------------------------+----------------------+-----------------------------------+----+-------+---------+-----------+----+----------------+--------+-------------+-------+-------------+---------+--------------+--------------------------+----------------------+------------------+------------------------------+-------------------------------------+--------------+----------+\n|CallNumber|UnitID|IncidentNumber|CallType                       |CallDate  |WatchDate |CallFinalDisposition      |AvailableDtTm         |Address                            |City|Zipcode|Battalion|StationArea|Box |OriginalPriority|Priority|FinalPriority|ALSUnit|CallTypeGroup|NumAlarms|UnitType      |UnitSequenceInCallDispatch|FirePreventionDistrict|SupervisorDistrict|Neighborhood                  |Location                             |RowID         |Delay     |\n+----------+------+--------------+-------------------------------+----------+----------+--------------------------+----------------------+-----------------------------------+----+-------+---------+-----------+----+----------------+--------+-------------+-------+-------------+---------+--------------+--------------------------+----------------------+------------------+------------------------------+-------------------------------------+--------------+----------+\n|110660238 |60    |11021821      |Medical Incident               |03/07/2011|03/07/2011|Fire                      |03/07/2011 04:23:05 PM|0 Block of BORICA ST               |SF  |94127  |B09      |19         |8442|3               |2       |2            |true   |null         |1        |MEDIC         |1                         |9                     |7                 |West of Twin Peaks            |(37.7225922041408, -122.468227979374)|110660238-60  |2.9       |\n|110660253 |B03   |11021831      |Alarms                         |03/07/2011|03/07/2011|Fire                      |03/07/2011 05:13:21 PM|1000 Block of HOWARD ST            |SF  |94103  |B03      |01         |2252|3               |3       |3            |false  |null         |1        |CHIEF         |3                         |3                     |6                 |South of Market               |(37.7795675906982, -122.407474134289)|110660253-B03 |2.3833334 |\n|110660282 |E43   |11021856      |Medical Incident               |03/07/2011|03/07/2011|Other                     |03/07/2011 06:55:52 PM|PERSIA AV/MADRID ST                |SF  |94112  |B09      |43         |6134|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |11                |Excelsior                     |(37.7216187707613, -122.432805977203)|110660282-E43 |1.65      |\n|110660322 |94    |11021888      |Medical Incident               |03/07/2011|03/07/2011|Other                     |03/07/2011 08:49:25 PM|1100 Block of HOWARD ST            |SF  |94103  |B03      |01         |2314|3               |3       |3            |true   |null         |1        |MEDIC         |3                         |2                     |6                 |South of Market               |(37.7768521020734, -122.410711239368)|110660322-94  |1.5666667 |\n|110670051 |B09   |11021963      |Alarms                         |03/08/2011|03/07/2011|Fire                      |03/08/2011 07:36:00 AM|5800 Block of MISSION ST           |SF  |94112  |B09      |33         |6213|3               |3       |3            |false  |null         |1        |CHIEF         |3                         |9                     |11                |Outer Mission                 |(37.709160030699, -122.451801431228) |110670051-B09 |2.8       |\n|110670076 |B06   |11021980      |Alarms                         |03/08/2011|03/08/2011|Fire                      |03/08/2011 08:52:16 AM|3600 Block of 20TH ST              |SF  |94110  |B06      |07         |5445|3               |3       |3            |false  |null         |1        |CHIEF         |2                         |6                     |8                 |Mission                       |(37.7584863037287, -122.422385383463)|110670076-B06 |2.5       |\n|110670077 |E44   |11021981      |Alarms                         |03/08/2011|03/08/2011|Other                     |03/08/2011 09:15:07 AM|1700 Block of VISITACION AVE       |SF  |94134  |B09      |44         |6263|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |10                |McLaren Park                  |(37.7162666820869, -122.414215025813)|110670077-E44 |1.6166667 |\n|110670082 |92    |11021988      |Medical Incident               |03/08/2011|03/08/2011|Code 2 Transport          |03/08/2011 10:23:19 AM|100 Block of GOLDEN GATE AVE       |SF  |94102  |B02      |01         |1546|1               |1       |2            |true   |null         |1        |MEDIC         |2                         |2                     |6                 |Tenderloin                    |(37.7820224371777, -122.413054148253)|110670082-92  |13.416667 |\n|110670089 |E01   |11021993      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 09:48:55 AM|200 Block of EDDY ST               |SF  |94102  |B03      |01         |1453|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |3                     |6                 |Tenderloin                    |(37.7840910361755, -122.411784369455)|110670089-E01 |3.55      |\n|110670101 |84    |11021998      |Medical Incident               |03/08/2011|03/08/2011|Code 2 Transport          |03/08/2011 11:13:38 AM|CALL BOX: SAN JOSE AV/SANTA YNEZ AV|SF  |94112  |B09      |15         |8276|2               |2       |2            |true   |null         |1        |MEDIC         |1                         |9                     |11                |Outer Mission                 |(37.7258249736518, -122.442324422614)|110670101-84  |4.55      |\n|110670122 |AM06  |11022013      |Medical Incident               |03/08/2011|03/08/2011|Unable to Locate          |03/08/2011 11:16:46 AM|1100 Block of MARKET ST            |SF  |94103  |B02      |01         |2316|1               |1       |2            |false  |null         |1        |PRIVATE       |1                         |2                     |6                 |South of Market               |(37.7795310846627, -122.413542548681)|110670122-AM06|5.9       |\n|110670124 |E44   |11022015      |Structure Fire                 |03/08/2011|03/08/2011|Other                     |03/08/2011 11:25:06 AM|400 Block of BURROWS ST            |SF  |94134  |B10      |42         |0633|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |10                    |9                 |Portola                       |(37.7278769871167, -122.407535487433)|110670124-E44 |0.7       |\n|110670144 |64    |11022031      |Medical Incident               |03/08/2011|03/08/2011|Code 2 Transport          |03/08/2011 12:57:16 PM|STOCKTON ST/PACIFIC AV             |SF  |94133  |B01      |02         |1332|2               |2       |2            |true   |null         |1        |MEDIC         |1                         |1                     |3                 |Chinatown                     |(37.7967039027671, -122.40843088815) |110670144-64  |6.4333334 |\n|110670145 |E34   |11022033      |Traffic Collision              |03/08/2011|03/08/2011|Other                     |03/08/2011 12:02:13 PM|CALIFORNIA ST/12TH AV              |SF  |94118  |B07      |31         |7147|3               |3       |3            |false  |null         |1        |ENGINE        |6                         |7                     |1                 |Inner Richmond                |(37.7845244780935, -122.470981483957)|110670145-E34 |3.3166666 |\n|110670156 |89    |11022042      |Medical Incident               |03/08/2011|03/08/2011|No Merit                  |03/08/2011 01:06:42 PM|100 Block of TURK ST               |SF  |94102  |B03      |01         |1456|1               |1       |2            |true   |null         |1        |MEDIC         |1                         |3                     |6                 |Tenderloin                    |(37.783163427134, -122.411599278937) |110670156-89  |5.483333  |\n|110670162 |E17   |11022047      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 12:56:41 PM|200 Block of WILLIAMS AVE          |SF  |94124  |B10      |42         |6474|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |10                    |10                |Bayview Hunters Point         |(37.7299346936044, -122.397744427103)|110670162-E17 |2.4166667 |\n|110670166 |54    |11022051      |Medical Incident               |03/08/2011|03/08/2011|Code 2 Transport          |03/08/2011 01:52:55 PM|3900 Block of 19TH ST              |SF  |94114  |B06      |06         |5436|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |6                     |8                 |Castro/Upper Market           |(37.7595451487512, -122.43153431347) |110670166-54  |2.3666666 |\n|110670195 |E22   |11022073      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 02:27:58 PM|1200 Block of 12TH AVE             |SF  |94122  |B08      |22         |7346|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |7                     |5                 |Inner Sunset                  |(37.7648362657127, -122.469656987954)|110670195-E22 |4.133333  |\n|110670201 |T11   |11022078      |Alarms                         |03/08/2011|03/08/2011|Other                     |03/08/2011 02:27:26 PM|3600 Block of 20TH ST              |SF  |94110  |B06      |07         |5445|3               |3       |3            |false  |null         |1        |TRUCK         |3                         |6                     |8                 |Mission                       |(37.7584863037287, -122.422385383463)|110670201-T11 |4.233333  |\n|110670235 |T14   |11022105      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 04:07:26 PM|500 Block of 27TH AVE              |SF  |94121  |B07      |14         |7222|3               |3       |3            |false  |null         |1        |TRUCK         |1                         |7                     |1                 |Outer Richmond                |(37.7790279638161, -122.486876869791)|110670235-T14 |2.8       |\n|110670243 |E32   |11022112      |Other                          |03/08/2011|03/08/2011|Fire                      |03/08/2011 04:17:21 PM|600 Block of JARBOE AVE            |SF  |94110  |B10      |32         |5734|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |10                    |9                 |Bernal Heights                |(37.7383166228201, -122.412430731479)|110670243-E32 |1.8166667 |\n|110670245 |AM14  |11022114      |Medical Incident               |03/08/2011|03/08/2011|Code 2 Transport          |03/08/2011 04:54:49 PM|800 Block of MARKET ST             |SF  |94102  |B03      |01         |2209|3               |3       |3            |false  |null         |1        |PRIVATE       |4                         |3                     |3                 |Tenderloin                    |(37.7843455364627, -122.407785146121)|110670245-AM14|29.3      |\n|110670275 |E31   |11022140      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 05:44:14 PM|0 Block of HEATHER AVE             |SF  |94118  |B05      |10         |4374|3               |3       |3            |true   |null         |1        |ENGINE        |3                         |5                     |2                 |Presidio Heights              |(37.7849179152553, -122.452798317588)|110670275-E31 |3.8166666 |\n|110670288 |E03   |11022150      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 06:31:47 PM|POST ST/VAN NESS AV                |SF  |94109  |B04      |03         |3161|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |4                     |5                 |Western Addition              |(37.7866189598827, -122.421570115493)|110670288-E03 |4.1       |\n|110670308 |AM10  |11022168      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 07:58:56 PM|1100 Block of KEPPLER CT           |TI  |94130  |B03      |48         |2931|E               |E       |3            |false  |null         |1        |PRIVATE       |5                         |None                  |6                 |Treasure Island               |(37.827591247874, -122.37675005814)  |110670308-AM10|2.25      |\n|110670311 |RC3   |11022170      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 08:05:41 PM|MINNA ST/6TH ST                    |SF  |94103  |B03      |01         |2251|E               |E       |3            |true   |null         |1        |RESCUE CAPTAIN|5                         |3                     |6                 |South of Market               |(37.7805353840251, -122.40816079453) |110670311-RC3 |4.1833334 |\n|110670317 |AM18  |11022176      |Medical Incident               |03/08/2011|03/08/2011|Code 2 Transport          |03/08/2011 09:42:04 PM|1100 Block of MISSION ST           |SF  |94103  |B02      |01         |2318|1               |1       |2            |false  |null         |1        |PRIVATE       |1                         |2                     |6                 |South of Market               |(37.7777124404316, -122.412736707425)|110670317-AM18|3.2166667 |\n|110670345 |E03   |11022202      |Medical Incident               |03/08/2011|03/08/2011|Other                     |03/08/2011 10:20:13 PM|300 Block of EDDY ST               |SF  |94102  |B02      |03         |1545|3               |3       |3            |true   |null         |1        |ENGINE        |4                         |2                     |6                 |Tenderloin                    |(37.7838385180026, -122.41377551206) |110670345-E03 |3.8       |\n|110680033 |E41   |11022254      |Alarms                         |03/09/2011|03/08/2011|Other                     |null                  |100 Block of EDDY ST               |SF  |94102  |B03      |01         |1453|3               |3       |3            |true   |null         |1        |ENGINE        |4                         |3                     |6                 |Tenderloin                    |(37.7842993825154, -122.410141319852)|110680033-E41 |4.15      |\n|110680043 |87    |11022262      |Medical Incident               |03/09/2011|03/08/2011|Other                     |03/09/2011 04:24:13 AM|600 Block of EDDY ST               |SF  |94109  |B02      |03         |1643|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |2                     |6                 |Tenderloin                    |(37.7832603861296, -122.41836615418) |110680043-87  |6.8166666 |\n|110680044 |KM15  |11022263      |Medical Incident               |03/09/2011|03/08/2011|Other                     |03/09/2011 04:47:59 AM|1200 Block of TURK ST              |SF  |94115  |B02      |05         |3426|3               |3       |3            |false  |null         |1        |PRIVATE       |2                         |2                     |5                 |Western Addition              |(37.7808662105665, -122.428803238005)|110680044-KM15|2.6       |\n|110680052 |93    |11022270      |Medical Incident               |03/09/2011|03/08/2011|Patient Declined Transport|03/09/2011 06:57:01 AM|100 Block of LAWRENCE AVE          |SF  |94112  |B09      |33         |8354|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |9                     |11                |Outer Mission                 |(37.7105193534208, -122.45216864615) |110680052-93  |1.65      |\n|110680091 |E06   |11022300      |Alarms                         |03/09/2011|03/09/2011|Other                     |03/09/2011 08:35:32 AM|400 Block of VALENCIA ST           |SF  |94103  |B02      |06         |5226|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |2                     |9                 |Mission                       |(37.7661343875141, -122.421935077177)|110680091-E06 |3.7333333 |\n|110680113 |B08   |11022316      |Structure Fire                 |03/09/2011|03/09/2011|Other                     |03/09/2011 09:35:37 AM|2600 Block of OCEAN AVE            |SF  |94132  |B08      |19         |8452|3               |3       |3            |false  |null         |1        |CHIEF         |5                         |8                     |7                 |West of Twin Peaks            |(37.7318468298435, -122.473738730856)|110680113-B08 |2.5666666 |\n|110680144 |E03   |11022330      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 10:32:52 AM|900 Block of GEARY ST              |SF  |94109  |B04      |03         |3116|3               |1       |2            |true   |null         |1        |ENGINE        |1                         |4                     |6                 |Tenderloin                    |(37.7859427265455, -122.418902557609)|110680144-E03 |2.7166667 |\n|110680150 |T08   |11022334      |Alarms                         |03/09/2011|03/09/2011|Other                     |03/09/2011 10:48:28 AM|800 Block of HOWARD ST             |SF  |94103  |B03      |01         |2214|3               |3       |3            |false  |null         |1        |TRUCK         |2                         |3                     |6                 |South of Market               |(37.7823404680537, -122.40377191669) |110680150-T08 |3.6666667 |\n|110680160 |RC3   |11022340      |Medical Incident               |03/09/2011|03/09/2011|Medical Examiner          |03/09/2011 11:38:05 AM|CALL BOX: GREAT HY/LAWTON ST       |SF  |94122  |B08      |23         |7724|E               |E       |3            |true   |null         |1        |RESCUE CAPTAIN|2                         |8                     |4                 |Sunset/Parkside               |(37.7564992367608, -122.508823790895)|110680160-RC3 |7.983333  |\n|110680188 |96    |11022364      |Medical Incident               |03/09/2011|03/09/2011|Code 2 Transport          |03/09/2011 01:11:48 PM|25TH ST/CONNECTICUT ST             |SF  |94107  |B10      |37         |2615|2               |2       |2            |true   |null         |1        |MEDIC         |1                         |10                    |10                |Potrero Hill                  |(37.7523107591, -122.396513496809)   |110680188-96  |2.1666667 |\n|110680224 |E01   |11022391      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 02:04:19 PM|0 Block of TURK ST                 |SF  |94102  |B03      |01         |1365|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |3                     |6                 |Tenderloin                    |(37.7833862379382, -122.409853729941)|110680224-E01 |3.2       |\n|110680247 |KM04  |11022393      |Medical Incident               |03/09/2011|03/09/2011|Code 2 Transport          |03/09/2011 02:52:46 PM|400 Block of 9TH ST                |SF  |94103  |B03      |29         |2333|3               |3       |3            |false  |null         |1        |PRIVATE       |2                         |3                     |6                 |South of Market               |(37.7721679781687, -122.409530896113)|110680247-KM04|2.7666667 |\n|110680318 |65    |11022414      |Medical Incident               |03/09/2011|03/09/2011|Patient Declined Transport|03/09/2011 03:41:37 PM|200 Block of TURK ST               |SF  |94102  |B03      |01         |1456|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |2                     |6                 |Tenderloin                    |(37.7829534931348, -122.413243748735)|110680318-65  |3.1666667 |\n|110680334 |E11   |11022423      |Alarms                         |03/09/2011|03/09/2011|Other                     |03/09/2011 04:06:29 PM|1700 Block of CHURCH ST            |SF  |94131  |B06      |11         |5563|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |6                     |8                 |Noe Valley                    |(37.7433025922865, -122.426563297214)|110680334-E11 |1.25      |\n|110680361 |RC1   |11022445      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 05:26:52 PM|2300 Block of POWELL ST            |SF  |94133  |B01      |28         |0131|E               |3       |3            |true   |null         |1        |RESCUE CAPTAIN|4                         |1                     |3                 |North Beach                   |(37.8063003263418, -122.411977425936)|110680361-RC1 |1.7166667 |\n|110680372 |B03   |11022457      |Alarms                         |03/09/2011|03/09/2011|Fire                      |03/09/2011 06:56:40 PM|300 Block of 3RD ST                |SF  |94107  |B03      |01         |2176|3               |3       |3            |false  |null         |1        |CHIEF         |3                         |3                     |6                 |South of Market               |(37.7833526602624, -122.398485675312)|110680372-B03 |1.2333333 |\n|110680409 |78    |11022494      |Medical Incident               |03/09/2011|03/09/2011|Code 2 Transport          |03/09/2011 08:51:42 PM|400 Block of TURK ST               |SF  |94102  |B02      |03         |1554|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |2                     |6                 |Tenderloin                    |(37.7825569563078, -122.416349428183)|110680409-78  |1.3833333 |\n|110680410 |E16   |11022495      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 08:09:43 PM|2200 Block of FRANCISCO ST         |SF  |94123  |B04      |16         |4114|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |4                     |2                 |Marina                        |(37.801071154331, -122.442212684496) |110680410-E16 |2.1666667 |\n|110680420 |E03   |11022502      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 08:36:13 PM|CEDAR ST/POLK ST                   |SF  |94109  |B04      |03         |1641|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |4                     |6                 |Tenderloin                    |(37.7863589505026, -122.419833090702)|110680420-E03 |3.3666666 |\n|110680429 |E41   |11022510      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 08:58:51 PM|OFARRELL ST/LARKIN ST              |SF  |94109  |B04      |03         |1642|3               |3       |3            |false  |null         |1        |ENGINE        |3                         |2                     |6                 |Tenderloin                    |(37.7851672146987, -122.41790141136) |110680429-E41 |5.233333  |\n|110680463 |E03   |11022542      |Medical Incident               |03/09/2011|03/09/2011|Other                     |03/09/2011 11:36:27 PM|300 Block of ELLIS ST              |SF  |94102  |B03      |03         |1461|1               |1       |2            |true   |null         |1        |ENGINE        |1                         |3                     |6                 |Tenderloin                    |(37.7849161843633, -122.411950042222)|110680463-E03 |5.9       |\n|110680466 |E13   |11022545      |Structure Fire                 |03/09/2011|03/09/2011|Fire                      |03/09/2011 11:42:38 PM|1ST ST/MARKET ST                   |SF  |94105  |B03      |13         |2143|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |1                     |6                 |Financial District/South Beach|(37.7910166481298, -122.399148598133)|110680466-E13 |1.5166667 |\n|110690007 |E03   |11022558      |Medical Incident               |03/10/2011|03/09/2011|Other                     |03/10/2011 12:43:33 AM|SUTTER ST/TAYLOR ST                |SF  |94102  |B01      |03         |1412|3               |3       |3            |true   |null         |1        |ENGINE        |2                         |1                     |3                 |Nob Hill                      |(37.7888075435186, -122.411885658758)|110690007-E03 |3.4333334 |\n|110690028 |89    |11022578      |Medical Incident               |03/10/2011|03/09/2011|Code 2 Transport          |03/10/2011 04:19:11 AM|0 Block of THOMAS MORE WAY         |SF  |94132  |B08      |33         |8773|3               |2       |2            |true   |null         |1        |MEDIC         |2                         |8                     |7                 |Lakeshore                     |(37.7122646664235, -122.472932437972)|110690028-89  |1.7166667 |\n|110690033 |94    |11022582      |Medical Incident               |03/10/2011|03/09/2011|No Merit                  |03/10/2011 03:47:51 AM|300 Block of EDDY ST               |SF  |94102  |B02      |03         |1545|2               |2       |2            |true   |null         |1        |MEDIC         |1                         |2                     |6                 |Tenderloin                    |(37.78373004094, -122.413753670487)  |110690033-94  |3.85      |\n|110690039 |E42   |11022587      |Medical Incident               |03/10/2011|03/09/2011|Other                     |03/10/2011 04:35:11 AM|1100 Block of FELTON ST            |SF  |94134  |B09      |42         |6147|3               |3       |3            |true   |null         |1        |ENGINE        |2                         |9                     |9                 |Excelsior                     |(37.7271223302083, -122.415960661052)|110690039-E42 |2.2666667 |\n|110690067 |E32   |11022609      |Medical Incident               |03/10/2011|03/09/2011|Other                     |03/10/2011 07:45:41 AM|SILVER AV/ALEMANY BL               |SF  |94112  |B09      |32         |8263|B               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |11                |Outer Mission                 |(37.7297755767155, -122.433386844031)|110690067-E32 |3.25      |\n|110690076 |68    |11022616      |Structure Fire                 |03/10/2011|03/10/2011|Other                     |03/10/2011 08:24:28 AM|0 Block of PRESIDIO TER            |SF  |94118  |B07      |10         |4444|3               |3       |3            |true   |null         |1        |MEDIC         |9                         |7                     |2                 |Inner Richmond                |(37.7881859123819, -122.461502002981)|110690076-68  |1.3333334 |\n|110690076 |D2    |11022616      |Structure Fire                 |03/10/2011|03/10/2011|Other                     |03/10/2011 08:26:24 AM|0 Block of PRESIDIO TER            |SF  |94118  |B07      |10         |4444|3               |3       |3            |false  |null         |1        |CHIEF         |4                         |7                     |2                 |Inner Richmond                |(37.7881859123819, -122.461502002981)|110690076-D2  |1.4666667 |\n|110690080 |T03   |11022620      |Structure Fire                 |03/10/2011|03/10/2011|Other                     |03/10/2011 08:32:04 AM|POLK ST/GEARY ST                   |SF  |94109  |B04      |03         |3116|3               |3       |3            |false  |null         |1        |TRUCK         |2                         |4                     |6                 |Tenderloin                    |(37.7858929010786, -122.419738734781)|110690080-T03 |2.25      |\n|110690115 |88    |11022638      |Medical Incident               |03/10/2011|03/10/2011|Code 3 Transport          |03/10/2011 10:59:32 AM|200 Block of PARNASSUS AVE         |SF  |94117  |B05      |12         |5155|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |5                     |5                 |Inner Sunset                  |(37.7642988660452, -122.453856213435)|110690115-88  |3.2       |\n|110690136 |T16   |11022649      |Water Rescue                   |03/10/2011|03/10/2011|Other                     |03/10/2011 12:04:34 PM|900 Block of MARINE DR             |PR  |94129  |B99      |51         |4628|3               |3       |3            |false  |null         |1        |TRUCK         |1                         |7                     |2                 |Presidio                      |(37.8089767888005, -122.47460956271) |110690136-T16 |3.1333334 |\n|110690138 |92    |11022651      |Medical Incident               |03/10/2011|03/10/2011|Code 2 Transport          |03/10/2011 12:21:05 PM|100 Block of CAPP ST               |SF  |94110  |B02      |07         |5236|3               |3       |3            |true   |null         |1        |MEDIC         |3                         |2                     |9                 |Mission                       |(37.7642993402288, -122.418551435984)|110690138-92  |4.016667  |\n|110690148 |AM06  |11022661      |Medical Incident               |03/10/2011|03/10/2011|Code 2 Transport          |03/10/2011 01:05:43 PM|100 Block of EDDY ST               |SF  |94102  |B03      |01         |1453|1               |1       |2            |false  |null         |1        |PRIVATE       |1                         |3                     |6                 |Tenderloin                    |(37.7842993825154, -122.410141319852)|110690148-AM06|3.8833334 |\n|110690159 |E43   |11022672      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 12:10:53 PM|800 Block of PARIS ST              |SF  |94112  |B09      |43         |6125|1               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |11                |Excelsior                     |(37.7161794056689, -122.439158315273)|110690159-E43 |9.65      |\n|110690160 |E19   |11022673      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 12:15:56 PM|500 Block of BUCKINGHAM WAY        |SF  |94132  |B08      |19         |8854|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |8                     |7                 |Lakeshore                     |(37.7301293750144, -122.478455492849)|110690160-E19 |4.0333333 |\n|110690168 |E01   |11022681      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 12:30:07 PM|0 Block of UNITED NATIONS PLZ      |SF  |94102  |B02      |01         |1551|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |2                     |6                 |Tenderloin                    |(37.7799444052046, -122.414317857881)|110690168-E01 |6.3333335 |\n|110690175 |B02   |11022688      |Structure Fire                 |03/10/2011|03/10/2011|Fire                      |03/10/2011 12:54:13 PM|900 Block of MARKET ST             |SF  |94103  |B03      |01         |2248|3               |3       |3            |false  |null         |1        |CHIEF         |2                         |3                     |6                 |South of Market               |(37.7826911213472, -122.409536662692)|110690175-B02 |2.8666666 |\n|110690175 |E03   |11022688      |Structure Fire                 |03/10/2011|03/10/2011|Other                     |03/10/2011 12:46:00 PM|900 Block of MARKET ST             |SF  |94103  |B03      |01         |2248|3               |3       |3            |true   |null         |1        |ENGINE        |6                         |3                     |6                 |South of Market               |(37.7826911213472, -122.409536662692)|110690175-E03 |6.016667  |\n|110690185 |KM12  |11022698      |Medical Incident               |03/10/2011|03/10/2011|Code 2 Transport          |03/10/2011 02:29:18 PM|100 Block of BARTLETT ST           |SF  |94110  |B06      |07         |5472|3               |3       |3            |false  |null         |1        |PRIVATE       |2                         |6                     |9                 |Mission                       |(37.7545635607749, -122.419850677817)|110690185-KM12|2.7       |\n|110690196 |E02   |11022705      |Structure Fire                 |03/10/2011|03/10/2011|Other                     |03/10/2011 01:44:33 PM|1000 Block of UNION ST             |SF  |94133  |B01      |28         |1513|3               |3       |3            |true   |null         |1        |ENGINE        |9                         |1                     |2                 |Russian Hill                  |(37.7996251250719, -122.416137153846)|110690196-E02 |2.4       |\n|110690208 |E15   |11022715      |Gas Leak (Natural and LP Gases)|03/10/2011|03/10/2011|Other                     |03/10/2011 02:07:11 PM|0 Block of BALTIMORE WAY           |SF  |94112  |B09      |43         |6233|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |11                |Excelsior                     |(37.7091138554638, -122.431830144186)|110690208-E15 |3.95      |\n|110690217 |E01   |11022722      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 02:28:33 PM|0 Block of TURK ST                 |SF  |94102  |B03      |01         |1365|3               |3       |3            |true   |null         |1        |ENGINE        |2                         |3                     |6                 |Tenderloin                    |(37.7832777786539, -122.409831752766)|110690217-E01 |1.15      |\n|110690230 |E19   |11022732      |Medical Incident               |03/10/2011|03/10/2011|No Merit                  |03/10/2011 02:42:20 PM|WINSTON DR/19TH AV                 |SF  |94132  |B08      |19         |8725|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |7                 |Lakeshore                     |(37.7269907019127, -122.474900344293)|110690230-E19 |2.5166667 |\n|110690246 |E40   |11022745      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 03:26:54 PM|2300 Block of 14TH AVE             |SF  |94116  |B08      |40         |0736|3               |2       |2            |true   |null         |1        |ENGINE        |1                         |8                     |7                 |West of Twin Peaks            |(37.7442210461058, -122.470369169759)|110690246-E40 |1.2666667 |\n|110690307 |58    |11022799      |Medical Incident               |03/10/2011|03/10/2011|Code 2 Transport          |03/10/2011 07:29:16 PM|2100 Block of POST ST              |SF  |94115  |B04      |10         |4131|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |4                     |5                 |Japantown                     |(37.7846877609559, -122.437204719428)|110690307-58  |2.9       |\n|110690315 |KM02  |11022807      |Medical Incident               |03/10/2011|03/10/2011|Patient Declined Transport|03/10/2011 07:04:15 PM|1000 Block of BUSH ST              |SF  |94109  |B01      |41         |1542|E               |3       |3            |false  |null         |1        |PRIVATE       |4                         |1                     |3                 |Nob Hill                      |(37.7894788173025, -122.414561133158)|110690315-KM02|2.4833333 |\n|110690327 |KM02  |11022819      |Medical Incident               |03/10/2011|03/10/2011|Code 2 Transport          |03/10/2011 08:10:53 PM|400 Block of EDDY ST               |SF  |94102  |B02      |03         |1545|3               |3       |3            |false  |null         |1        |PRIVATE       |1                         |2                     |6                 |Tenderloin                    |(37.7835654755497, -122.415051136249)|110690327-KM02|3.4666667 |\n|110690341 |T05   |11022832      |Alarms                         |03/10/2011|03/10/2011|Other                     |03/10/2011 08:14:08 PM|1000 Block of STEINER ST           |SF  |94115  |B05      |05         |3625|3               |3       |3            |false  |null         |1        |TRUCK         |1                         |5                     |5                 |Western Addition              |(37.7788798213187, -122.433569963601)|110690341-T05 |4.3166666 |\n|110690352 |78    |11022840      |Structure Fire                 |03/10/2011|03/10/2011|Other                     |03/10/2011 08:52:28 PM|400 Block of 3RD AVE               |SF  |94118  |B07      |31         |7117|3               |3       |3            |true   |null         |1        |MEDIC         |5                         |7                     |1                 |Inner Richmond                |(37.7802004442701, -122.46092794533) |110690352-78  |3.4666667 |\n|110690353 |59    |11022841      |Medical Incident               |03/10/2011|03/10/2011|Code 2 Transport          |03/10/2011 09:49:10 PM|600 Block of EDDY ST               |SF  |94109  |B02      |03         |1643|2               |2       |2            |true   |null         |1        |MEDIC         |1                         |2                     |6                 |Tenderloin                    |(37.7832603861296, -122.41836615418) |110690353-59  |3.5666666 |\n|110690367 |E07   |11022853      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 10:00:33 PM|500 Block of CAPP ST               |SF  |94110  |B06      |07         |5446|3               |3       |3            |true   |null         |1        |ENGINE        |2                         |6                     |9                 |Mission                       |(37.7578954435745, -122.417957286582)|110690367-E07 |3.65      |\n|110690382 |E08   |11022868      |Medical Incident               |03/10/2011|03/10/2011|Other                     |03/10/2011 11:16:48 PM|500 Block of 5TH ST                |SF  |94107  |B03      |08         |2242|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |3                     |6                 |South of Market               |(37.7776242389287, -122.39998111124) |110690382-E08 |2.65      |\n|110700011 |E06   |11022886      |Traffic Collision              |03/11/2011|03/10/2011|Other                     |03/11/2011 01:04:42 AM|15TH ST/GUERRERO ST                |SF  |94103  |B02      |06         |5226|3               |3       |3            |true   |null         |1        |ENGINE        |2                         |2                     |8                 |Mission                       |(37.7664057681804, -122.42425811346) |110700011-E06 |4.15      |\n|110700012 |KM15  |11022887      |Medical Incident               |03/11/2011|03/10/2011|Code 2 Transport          |03/11/2011 02:06:56 AM|0 Block of MASON ST                |SF  |94102  |B03      |01         |1365|3               |2       |2            |false  |null         |1        |PRIVATE       |1                         |3                     |6                 |Tenderloin                    |(37.7837892969292, -122.409266307301)|110700012-KM15|3.3833334 |\n|110700013 |E13   |11022888      |Traffic Collision              |03/11/2011|03/10/2011|No Merit                  |03/11/2011 02:15:24 AM|MARKET ST/MONTGOMERY ST            |SF  |94105  |B01      |13         |1236|2               |2       |2            |true   |null         |1        |ENGINE        |1                         |3                     |6                 |Financial District/South Beach|(37.7887211505214, -122.402065731707)|110700013-E13 |1.8166667 |\n|110700023 |T05   |11022898      |Alarms                         |03/11/2011|03/10/2011|Other                     |03/11/2011 02:18:18 AM|1800 Block of MCALLISTER ST        |SF  |94115  |B05      |21         |4254|3               |3       |3            |false  |null         |1        |TRUCK         |2                         |5                     |5                 |Lone Mountain/USF             |(37.777323102471, -122.442510566382) |110700023-T05 |3.8333333 |\n|110700037 |E08   |11022912      |Medical Incident               |03/11/2011|03/10/2011|Other                     |03/11/2011 04:20:43 AM|700 Block of 4TH ST                |SF  |94107  |B03      |08         |2224|1               |1       |2            |true   |null         |1        |ENGINE        |2                         |3                     |6                 |Mission Bay                   |(37.7766724490311, -122.394557370624)|110700037-E08 |5.9       |\n|110700041 |73    |11022915      |Medical Incident               |03/11/2011|03/10/2011|Code 2 Transport          |03/11/2011 05:31:15 AM|0 Block of DORE ST                 |SF  |94103  |B02      |36         |2342|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |2                     |6                 |South of Market               |(37.7739392650435, -122.412947871011)|110700041-73  |5.733333  |\n|110700074 |E33   |11022942      |Traffic Collision              |03/11/2011|03/11/2011|Other                     |03/11/2011 09:02:05 AM|0 Block of ORIZABA AVE             |SF  |94132  |B09      |33         |8364|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |11                |Oceanview/Merced/Ingleside    |(37.7109803777384, -122.462497075283)|110700074-E33 |3.1       |\n|110700076 |E42   |11022944      |Medical Incident               |03/11/2011|03/11/2011|Other                     |03/11/2011 08:28:12 AM|300 Block of UNIVERSITY ST         |SF  |94134  |B09      |42         |6345|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |9                     |9                 |Portola                       |(37.7257685961984, -122.413836028914)|110700076-E42 |2.2166667 |\n|110700098 |83    |11022962      |Medical Incident               |03/11/2011|03/11/2011|Code 3 Transport          |03/11/2011 10:30:42 AM|1100 Block of MARKET ST            |SF  |94102  |B02      |01         |2309|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |2                     |6                 |Tenderloin                    |(37.7796660426062, -122.41371122073) |110700098-83  |0.71666664|\n|110700102 |E28   |11022964      |Medical Incident               |03/11/2011|03/11/2011|Patient Declined Transport|03/11/2011 09:38:10 AM|1800 Block of KEARNY ST            |SF  |94133  |B01      |28         |1255|3               |2       |2            |false  |null         |1        |ENGINE        |1                         |1                     |3                 |North Beach                   |(37.804809171271, -122.406795529826) |110700102-E28 |1.7       |\n|110700106 |E01   |11022967      |Medical Incident               |03/11/2011|03/11/2011|Other                     |03/11/2011 10:02:35 AM|POWELL ST/GEARY ST                 |SF  |94102  |B01      |01         |1362|3               |2       |2            |true   |null         |1        |ENGINE        |1                         |1                     |3                 |Financial District/South Beach|(37.7873592619506, -122.408226727064)|110700106-E01 |1.5833334 |\n|110700155 |96    |11023001      |Medical Incident               |03/11/2011|03/11/2011|Code 2 Transport          |03/11/2011 12:14:21 PM|200 Block of NOE ST                |SF  |94114  |B05      |06         |5233|3               |3       |3            |true   |null         |1        |MEDIC         |2                         |5                     |8                 |Castro/Upper Market           |(37.7654653107492, -122.43314806477) |110700155-96  |0.6666667 |\n|110700160 |AM16  |11023004      |Medical Incident               |03/11/2011|03/11/2011|Other                     |03/11/2011 11:27:53 AM|0 Block of JACKSON ST              |SF  |94111  |B01      |13         |1132|3               |3       |3            |false  |null         |1        |PRIVATE       |2                         |1                     |3                 |Financial District/South Beach|(37.7972220799644, -122.397746040475)|110700160-AM16|3.45      |\n|110700161 |56    |11023005      |Medical Incident               |03/11/2011|03/11/2011|Code 2 Transport          |03/11/2011 12:27:08 PM|2000 Block of LANE ST              |SF  |94124  |B10      |17         |6536|3               |3       |3            |true   |null         |1        |MEDIC         |3                         |10                    |10                |Bayview Hunters Point         |(37.7294407358981, -122.392077468459)|110700161-56  |3.3       |\n|110700186 |64    |11023022      |Medical Incident               |03/11/2011|03/11/2011|Code 2 Transport          |03/11/2011 02:17:59 PM|1600 Block of MARKET ST            |SF  |94103  |B02      |36         |3311|2               |2       |2            |true   |null         |1        |MEDIC         |1                         |2                     |6                 |Mission                       |(37.7726948236861, -122.422188261426)|110700186-64  |4.75      |\n|110700191 |84    |11023026      |Medical Incident               |03/11/2011|03/11/2011|Code 2 Transport          |03/11/2011 01:56:47 PM|MARKET ST/5TH ST                   |SF  |94103  |B03      |01         |1364|3               |3       |3            |true   |null         |1        |MEDIC         |1                         |3                     |6                 |South of Market               |(37.7839914857614, -122.408066547804)|110700191-84  |2.65      |\n|110700205 |E28   |11023038      |Medical Incident               |03/11/2011|03/11/2011|Other                     |03/11/2011 01:45:27 PM|POWELL ST/FRANCISCO ST             |SF  |94133  |B01      |28         |0131|B               |B       |2            |false  |null         |1        |ENGINE        |1                         |1                     |3                 |North Beach                   |(37.8048960105792, -122.411766482067)|110700205-E28 |5.383333  |\n|110700219 |E21   |11023051      |Medical Incident               |03/11/2011|03/11/2011|Other                     |03/11/2011 02:48:45 PM|800 Block of FULTON ST             |SF  |94117  |B05      |05         |3521|2               |2       |2            |false  |null         |1        |ENGINE        |1                         |2                     |5                 |Hayes Valley                  |(37.7777004665832, -122.431132874375)|110700219-E21 |3.6666667 |\n|110700265 |E42   |11023085      |Medical Incident               |03/11/2011|03/11/2011|Other                     |03/11/2011 04:41:56 PM|1700 Block of QUINT ST             |SF  |94124  |B10      |42         |6445|3               |3       |3            |true   |null         |1        |ENGINE        |1                         |10                    |10                |Bayview Hunters Point         |(37.7350748815594, -122.398827357293)|110700265-E42 |2.1       |\n+----------+------+--------------+-------------------------------+----------+----------+--------------------------+----------------------+-----------------------------------+----+-------+---------+-----------+----+----------------+--------+-------------+-------+-------------+---------+--------------+--------------------------+----------------------+------------------+------------------------------+-------------------------------------+--------------+----------+\nonly showing top 100 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637237189822_1836375681","id":"20201119-184503_1883561312","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T16:54:48+0300","dateFinished":"2021-11-18T16:54:49+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5713"},{"title":"What were all the different types of fire calls in 2018?","text":"%pyspark\nimport pyspark.sql.functions as f\n\nfireDF \\\n.withColumn(\"CallDate\", \n    f.to_timestamp(f.col(\"CallDate\"), 'dd/MM/yyyy'))\\\n.withColumn(\"CallYear\", f.year(\"CallDate\"))\\\n.where(\"CallYear = '2018'\") \\\n.select(\"CallType\")\\\n.distinct()\\\n.show(1000, False)\n","user":"admin","dateUpdated":"2021-11-18T20:48:10+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":5,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{"columns":[{"name":"State","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Color","visible":true,"width":"*","sort":{},"filters":[{}],"pinned":""},{"name":"Count","visible":true,"width":"*","sort":{"priority":0,"direction":"desc"},"filters":[{}],"pinned":""}],"scrollFocus":{},"selection":[],"grouping":{"grouping":[],"aggregations":[],"rowExpandedStates":{}},"treeView":{},"pagination":{"paginationCurrentPage":1,"paginationPageSize":250}},"tableColumnTypeState":{"names":{"State":"string","Color":"string","Count":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"State","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Count","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------+\n|CallType                       |\n+-------------------------------+\n|Medical Incident               |\n|Citizen Assist / Service Call  |\n|Traffic Collision              |\n|Alarms                         |\n|Structure Fire                 |\n|Outside Fire                   |\n|Smoke Investigation (Outside)  |\n|Vehicle Fire                   |\n|Other                          |\n|Water Rescue                   |\n|Electrical Hazard              |\n|Gas Leak (Natural and LP Gases)|\n|Elevator / Escalator Rescue    |\n|HazMat                         |\n|Odor (Strange / Unknown)       |\n|Fuel Spill                     |\n|Assist Police                  |\n|Train / Rail Incident          |\n+-------------------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189823_-1296353872","id":"20201119-183637_1720828841","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T20:45:54+0300","dateFinished":"2021-11-18T20:45:55+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5714"},{"title":"What months within the year 2018 saw the highest number of fire calls?","text":"%pyspark\n\nfireDF\\\n.withColumn(\"CallDate\", f.to_timestamp(f.col(\"CallDate\"), 'dd/MM/yyyy'))\\\n.withColumn(\"CallMonth\", f.month(\"CallDate\"))\\\n.withColumn(\"CallYear\", f.year(\"CallDate\"))\\\n.where(\"CallYear = '2018'\") \\\n.groupBy(\"CallMonth\")\\\n.agg(\n    f.countDistinct(\"callNumber\").alias(\"call_count\")\n    )\\\n.orderBy(\"call_count\", ascending=False)\\\n.show()\n","user":"admin","dateUpdated":"2021-11-18T20:48:38+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":7,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+----------+\n|CallMonth|call_count|\n+---------+----------+\n|        1|       400|\n|        4|       369|\n|        2|       367|\n|        7|       342|\n|        3|       341|\n|        5|       340|\n|        6|       337|\n|       12|       320|\n|       11|       313|\n|        9|       306|\n|        8|       304|\n|       10|       298|\n+---------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189829_-1280648849","id":"20201123-153948_182435555","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T16:55:48+0300","dateFinished":"2021-11-18T16:55:54+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5715"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2021-11-18T16:55:52+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637243752071_-1328840749","id":"20211118-165552_1242840115","dateCreated":"2021-11-18T16:55:52+0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5716"},{"title":"Which neighborhood in San Francisco generated the most fire calls in 2018?","text":"%pyspark\n\n(fireDF\n.groupBy(\"Neighborhood\")\n.agg(countDistinct(\"callNumber\").alias(\"call_count\"))\n.orderBy(\"call_count\", ascending=False)\n.show(1000, False))","user":"admin","dateUpdated":"2021-11-18T20:50:00+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------+----------+\n|Neighborhood                  |call_count|\n+------------------------------+----------+\n|Tenderloin                    |22025     |\n|South of Market               |16115     |\n|Mission                       |15364     |\n|Financial District/South Beach|11472     |\n|Bayview Hunters Point         |9208      |\n|Sunset/Parkside               |6704      |\n|Western Addition              |6317      |\n|Nob Hill                      |5587      |\n|Outer Richmond                |4387      |\n|Hayes Valley                  |4182      |\n|Castro/Upper Market           |4021      |\n|West of Twin Peaks            |3846      |\n|North Beach                   |3655      |\n|Chinatown                     |3594      |\n|Excelsior                     |3503      |\n|Pacific Heights               |3443      |\n|Marina                        |3255      |\n|Potrero Hill                  |3198      |\n|Bernal Heights                |3130      |\n|Inner Sunset                  |2827      |\n|Russian Hill                  |2614      |\n|Lakeshore                     |2527      |\n|Haight Ashbury                |2496      |\n|Outer Mission                 |2495      |\n|Oceanview/Merced/Ingleside    |2440      |\n|Visitacion Valley             |2334      |\n|Inner Richmond                |2310      |\n|Lone Mountain/USF             |2024      |\n|Mission Bay                   |1851      |\n|Noe Valley                    |1780      |\n|Portola                       |1625      |\n|Presidio Heights              |1568      |\n|Japantown                     |1527      |\n|Treasure Island               |1044      |\n|Golden Gate Park              |1001      |\n|Twin Peaks                    |996       |\n|Glen Park                     |809       |\n|Presidio                      |511       |\n|Seacliff                      |249       |\n|McLaren Park                  |201       |\n|None                          |177       |\n|Lincoln Park                  |159       |\n+------------------------------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189830_-792991470","id":"20201123-154035_642016321","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5717"},{"title":"Which neighborhoods had the worst response times to fire calls in 2018?","text":"%pyspark\n\nfireDF\\\n.where(\"lower(CallType) like '%fire%'\")\\\n.select(\"Neighborhood\", \"delay\", \"callType\")\\\n.orderBy(\"delay\", ascending=False)\\\n.show()","user":"admin","dateUpdated":"2021-11-18T15:06:29+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+---------+--------------+\n|        Neighborhood|    delay|      callType|\n+--------------------+---------+--------------+\n|     Sunset/Parkside| 99.63333|Structure Fire|\n|             Mission|949.11664|Structure Fire|\n|           Chinatown|   931.45|Structure Fire|\n|             Mission| 92.51667|Structure Fire|\n|     Treasure Island|91.916664|  Outside Fire|\n|              Marina|     91.6|Structure Fire|\n|Financial Distric...| 9.983334|  Outside Fire|\n|      Inner Richmond| 9.983334|Structure Fire|\n|Financial Distric...| 9.983334|Structure Fire|\n|          Tenderloin| 9.966666|Structure Fire|\n|      Bernal Heights| 9.966666|Structure Fire|\n|            Presidio| 9.966666|Structure Fire|\n|     South of Market| 9.933333|  Outside Fire|\n|     South of Market| 9.933333|Structure Fire|\n|Bayview Hunters P...| 9.933333|Structure Fire|\n|     Pacific Heights| 9.916667|Structure Fire|\n|           Excelsior| 9.916667|Structure Fire|\n|Bayview Hunters P...| 9.916667|Structure Fire|\n|   Visitacion Valley| 9.916667|Structure Fire|\n|      Inner Richmond| 9.916667|Structure Fire|\n+--------------------+---------+--------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637237189831_1588603020","id":"20201123-154048_1864288634","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5718"},{"title":"Which week in the year in 2018 had the most fire calls?","text":"%pyspark\n\nfireDF\\\n.where(\"lower(CallType) like '%fire%'\")\\\n.withColumn(\"CallDate\", f.to_timestamp(f.col(\"CallDate\"), 'dd/MM/yyyy'))\\\n.withColumn(\"CallWeek\", f.weekofyear(\"CallDate\"))\\\n.withColumn(\"CallYear\", f.year(\"CallDate\"))\\\n.where(\"CallYear = '2018'\") \\\n.groupBy(\"CallYear\", \"CallWeek\")\\\n.agg(\n    f.countDistinct(\"callNumber\").alias(\"call_count\")\n    )\\\n.orderBy(\"call_count\", ascending=False)\\\n.show()\n","user":"admin","dateUpdated":"2021-11-18T16:56:28+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------+----------+\n|CallYear|CallWeek|call_count|\n+--------+--------+----------+\n|    2018|       1|        30|\n|    2018|       6|        25|\n|    2018|      27|        25|\n|    2018|      23|        24|\n|    2018|      14|        23|\n|    2018|      10|        22|\n|    2018|      18|        21|\n|    2018|      49|        20|\n|    2018|      31|        18|\n|    2018|      40|        18|\n|    2018|      36|        18|\n|    2018|      32|        16|\n|    2018|      45|        14|\n|    2018|      19|        14|\n|    2018|       2|        14|\n|    2018|      22|        13|\n|    2018|       9|        13|\n|    2018|      15|        11|\n|    2018|      35|         9|\n|    2018|      28|         9|\n+--------+--------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1637237189832_1034249180","id":"20201123-160026_1960750235","dateCreated":"2021-11-18T15:06:29+0300","dateStarted":"2021-11-18T16:56:28+0300","dateFinished":"2021-11-18T16:56:32+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:5719"},{"title":"Which week in the year in 2018 had the most fire calls?","text":"%pyspark\n","user":"admin","dateUpdated":"2021-11-18T15:06:29+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637237189833_864424219","id":"20201123-160035_178312652","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5720"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2021-11-18T16:56:46+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637243806320_2074259192","id":"20211118-165646_1749458855","dateCreated":"2021-11-18T16:56:46+0300","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:5721"},{"title":"Create UDF","text":"%pyspark\n\ndf1 = spark.createDataFrame([\n    (1, \"andy\", 20, \"USA\"), \n    (2, \"jeff\", 23, \"China\"), \n    (3, \"james\", 18, \"USA\")]) \\\n.toDF(\"id\", \"name\", \"age\", \"country\")\n\n# Create udf create python lambda\nfrom pyspark.sql.functions import udf\nudf1 = udf(lambda e: e.upper())\ndf2 = df1.select(udf1(df1[\"name\"]))\ndf2.show()\n\n# UDF could also be used in filter, in this case the return type must be Boolean\n# We can also use annotation to create udf\nfrom pyspark.sql.types import *\n\n@udf(returnType=BooleanType())\ndef udf2(e):\n    if e >= 20:\n        return True;\n    else:\n        return False\n\ndf3 = df1.filter(udf2(df1[\"age\"]))\ndf3.show()\n\n# UDF could also accept more than 1 argument.\nudf3 = udf(lambda e1, e2: e1 + \"_\" + e2)\ndf4 = df1.select(udf3(df1[\"name\"], df1[\"country\"]).alias(\"name_country\"))\ndf4.show()\n","user":"admin","dateUpdated":"2021-11-18T20:53:34+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+\n|<lambda>(name)|\n+--------------+\n|          ANDY|\n|          JEFF|\n|         JAMES|\n+--------------+\n\n+---+----+---+-------+\n| id|name|age|country|\n+---+----+---+-------+\n|  1|andy| 20|    USA|\n|  2|jeff| 23|  China|\n+---+----+---+-------+\n\n+------------+\n|name_country|\n+------------+\n|    andy_USA|\n|  jeff_China|\n|   james_USA|\n+------------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189838_1294912797","id":"20201119-155951_457057931","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5722"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2021-11-18T15:06:29+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637237189840_376115912","id":"20201119-160541_1487929652","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5723"},{"title":"Join on Single Field","text":"%pyspark\n\ndf1 = spark.createDataFrame([\n    (1, \"andy\", 20, 1), \n    (2, \"jeff\", 23, 2), \n    (3, \"james\", 18, 3)])\n    .toDF(\"id\", \"name\", \"age\", \"c_id\")\n    \ndf1.show()\n\ndf2 = spark.createDataFrame([(1, \"USA\"), (2, \"China\")]).toDF(\"c_id\", \"c_name\")\ndf2.show()\n\n# You can just specify the key name if join on the same key\ndf3 = df1.join(df2, on=[\"c_id\"], how=\"inner\")\ndf3.show()\n\n# Or you can specify the join condition expclitly in case the key is different between tables\ndf4 = df1.join(df2, df1[\"c_id\"] == df2[\"c_id\"] )\ndf4.show()\n\n# You can specify the join type afte the join condition, by default it is inner join\ndf5 = df1.join(df2, df1[\"c_id\"] == df2[\"c_id\"], \"left_outer\")\ndf5.show()","user":"admin","dateUpdated":"2021-11-18T20:55:45+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+---+----+\n| id| name|age|c_id|\n+---+-----+---+----+\n|  1| andy| 20|   1|\n|  2| jeff| 23|   2|\n|  3|james| 18|   3|\n+---+-----+---+----+\n\n+----+------+\n|c_id|c_name|\n+----+------+\n|   1|   USA|\n|   2| China|\n+----+------+\n\n+----+---+----+---+------+\n|c_id| id|name|age|c_name|\n+----+---+----+---+------+\n|   1|  1|andy| 20|   USA|\n|   2|  2|jeff| 23| China|\n+----+---+----+---+------+\n\n+---+----+---+----+----+------+\n| id|name|age|c_id|c_id|c_name|\n+---+----+---+----+----+------+\n|  1|andy| 20|   1|   1|   USA|\n|  2|jeff| 23|   2|   2| China|\n+---+----+---+----+----+------+\n\n+---+-----+---+----+----+------+\n| id| name|age|c_id|c_id|c_name|\n+---+-----+---+----+----+------+\n|  1| andy| 20|   1|   1|   USA|\n|  3|james| 18|   3|null|  null|\n|  2| jeff| 23|   2|   2| China|\n+---+-----+---+----+----+------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189841_618271456","id":"20201119-155952_2018022643","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5724"},{"title":"Join on Multiple Fields","text":"%pyspark\n\ndf1 = spark.createDataFrame([(\"andy\", 20, 1, 1), (\"jeff\", 23, 1, 2), (\"james\", 12, 2, 2)]).toDF(\"name\", \"age\", \"key_1\", \"key_2\")\ndf1.show()\n\ndf2 = spark.createDataFrame([(1, 1, \"USA\"), (2, 2, \"China\")]).toDF(\"key_1\", \"key_2\", \"country\")\ndf2.show()\n\n# Join on 2 fields: key_1, key_2\n\n# You can pass a list of field name if the join field names are the same in both tables\ndf3 = df1.join(df2, [\"key_1\", \"key_2\"])\ndf3.show()\n\n# Or you can specify the join condition expclitly in case when the join fields name is differetnt in the two tables\ndf4 = df1.join(df2, (df1[\"key_1\"] == df2[\"key_1\"]) & (df1[\"key_2\"] == df2[\"key_2\"]))\ndf4.show()\n\n","user":"admin","dateUpdated":"2021-11-18T15:06:29+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+---+-----+-----+\n| name|age|key_1|key_2|\n+-----+---+-----+-----+\n| andy| 20|    1|    1|\n| jeff| 23|    1|    2|\n|james| 12|    2|    2|\n+-----+---+-----+-----+\n\n+-----+-----+-------+\n|key_1|key_2|country|\n+-----+-----+-------+\n|    1|    1|    USA|\n|    2|    2|  China|\n+-----+-----+-------+\n\n+-----+-----+-----+---+-------+\n|key_1|key_2| name|age|country|\n+-----+-----+-----+---+-------+\n|    1|    1| andy| 20|    USA|\n|    2|    2|james| 12|  China|\n+-----+-----+-----+---+-------+\n\n+-----+---+-----+-----+-----+-----+-------+\n| name|age|key_1|key_2|key_1|key_2|country|\n+-----+---+-----+-----+-----+-----+-------+\n| andy| 20|    1|    1|    1|    1|    USA|\n|james| 12|    2|    2|    2|    2|  China|\n+-----+---+-----+-----+-----+-----+-------+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189842_143688690","id":"20201119-155952_1524810954","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5725"},{"title":"spark.sql directly","text":"%pyspark\n\ndf1 = spark.createDataFrame([\n        (1, \"andy\", 20, \"USA\"), \n        (2, \"jeff\", 23, \"China\"), \n        (3, \"james\", 18, \"USA\")]) \\\n    .toDF(\"id\", \"name\", \"age\", \"country\")\n    \ndf1.createOrReplaceTempView(\"people\")\n\ndf2 = spark.\n(\"select name, age from people\")\ndf2.show()","user":"admin","dateUpdated":"2021-11-18T20:59:42+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+---+\n| name|age|\n+-----+---+\n| andy| 20|\n| jeff| 23|\n|james| 18|\n+-----+---+\n\n+----------+---+\n|udf1(name)|age|\n+----------+---+\n|      ANDY| 20|\n|      JEFF| 23|\n|     JAMES| 18|\n+----------+---+\n\n"}]},"apps":[],"jobName":"paragraph_1637237189844_553146411","id":"20201119-160613_1033868239","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5726"},{"text":"%pyspark\n","user":"admin","dateUpdated":"2021-11-18T15:06:29+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637237189849_2126229048","id":"20201123-175407_2080877547","dateCreated":"2021-11-18T15:06:29+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:5727"}],"name":"/it_3/2 lecture","id":"2GPZDBVXJ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sparkLocal:shared_process":[],"python:shared_process":[],"sh:shared_process":[],"spark::2GPZDBVXJ":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}