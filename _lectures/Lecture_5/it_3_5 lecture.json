{"paragraphs":[{"text":"%md\n\n# RDD","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>RDD</h1>\n"}]},"apps":[],"jobName":"paragraph_1637854886146_-942320955","id":"20210625-154914_1758448035","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17422"},{"text":"%pyspark\n\nmydata = [1, 2, 2, 3, 4, 5, 5, 5, 6]\n\nrdd = sc.parallelize(mydata)\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1637854886148_151747767","id":"20210625-154939_376771714","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17423"},{"text":"%pyspark\n\nrdd.collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 2, 3, 4, 5, 5, 5, 6]\n"}]},"apps":[],"jobName":"paragraph_1637854886150_72444510","id":"20210923-162629_788768494","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17424"},{"title":"map()","text":"%pyspark\n\nnew_RDD = rdd.map(lambda x: x * 2)\n\nnew_RDD.take(10)\n","user":"admin","dateUpdated":"2021-11-29T20:12:43+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 4, 6, 8, 10, 10, 10, 12]\n"}]},"apps":[],"jobName":"paragraph_1637854886151_1426517635","id":"20210625-154939_763262825","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17425"},{"title":"filter()","text":"%pyspark\nnew_RDD = rdd.filter(lambda x: x >= 4)\n\nnew_RDD.take(10)","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[4, 5, 5, 5, 6]\n"}]},"apps":[],"jobName":"paragraph_1637854886152_-814346836","id":"20210625-155123_119615328","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17426"},{"title":"distinct()","text":"%pyspark\n\nnew_RDD = rdd.distinct()\n\nnew_RDD.take(10)\n","user":"admin","dateUpdated":"2021-11-29T20:14:02+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 4, 6, 1, 3, 5]\n"}]},"apps":[],"jobName":"paragraph_1637854886153_1680807972","id":"20210625-155123_1748489399","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17427"},{"title":"union()","text":"%pyspark\n\nrdd2 = sc.parallelize([2, 2, 3, 5, 6, 6, 7, 8, 9])\nnew_RDD = rdd.union(rdd2)\nnew_RDD.take(20)\n","user":"admin","dateUpdated":"2021-11-29T20:14:17+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 2, 3, 5, 6, 6, 7, 8, 9, 0, 2, 2, 3, 5, 6, 6, 7, 8, 9]\n"}]},"apps":[],"jobName":"paragraph_1637854886154_1885846867","id":"20210625-155123_1547756477","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17428"},{"title":"reduce","text":"%pyspark\n\nrdd.reduce(lambda x, y: x + y)","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"48\n"}]},"apps":[],"jobName":"paragraph_1637854886156_1815053492","id":"20210625-162822_556845524","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17429"},{"title":"intersection()","text":"%pyspark\n\nnew_RDD = rdd.intersection(rdd2)\n\nnew_RDD.take(10)\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[5, 2, 6, 3]\n"}]},"apps":[],"jobName":"paragraph_1637854886157_560071365","id":"20210625-155123_1062602753","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17430"},{"title":"subtract()","text":"%pyspark\n\nnew_RDD = rdd.subtract(rdd2)\n\nnew_RDD.take(10)\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[4, 1]\n"}]},"apps":[],"jobName":"paragraph_1637854886158_1207885574","id":"20210625-155123_1819558632","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17431"},{"title":"sample()","text":"%pyspark\n\nnew_RDD = rdd.sample(False, 0.5)\n\nnew_RDD.collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[1, 2, 4, 5]\n"}]},"apps":[],"jobName":"paragraph_1637854886159_-186768974","id":"20210625-155122_2070204927","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17432"},{"text":"%md\n\n# PAIR RDD Transformations","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>PAIR RDD Transformations</h1>\n"}]},"apps":[],"jobName":"paragraph_1637854886160_-235818693","id":"20210625-154936_1657186224","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17433"},{"title":"groupByKey()","text":"%pyspark\n\nrdd=sc.parallelize([ \n    (1, 2),\n    (1, 5),\n    (3, 4),\n    (3, 6)])\n\nrdd.groupByKey().collect()\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, <pyspark.resultiterable.ResultIterable object at 0x7fd506bc5050>), (3, <pyspark.resultiterable.ResultIterable object at 0x7fd506bc50d0>)]\n"}]},"apps":[],"jobName":"paragraph_1637854886162_-631085965","id":"20210625-161335_754734342","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17434"},{"title":"reduceByKey()","text":"%pyspark\n\nrdd.groupByKey().map(lambda x:(x[0], list(x[1])) ).collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, [2, 5]), (3, [4, 6])]\n"}]},"apps":[],"jobName":"paragraph_1637854886163_523546226","id":"20210625-161343_1473915473","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17435"},{"text":"%pyspark\n\nrdd.groupByKey().map(lambda x:(x[0], sum(x[1])) ).collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 7), (3, 10)]\n"}]},"apps":[],"jobName":"paragraph_1637854886164_1550094326","id":"20210625-162204_1146527437","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17436"},{"title":"reduceByKey()","text":"%pyspark\n\nrdd.reduceByKey(lambda x, y: x + y).collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 7), (3, 10)]\n"}]},"apps":[],"jobName":"paragraph_1637854886165_-1736507805","id":"20210625-161343_2139743726","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17437"},{"title":"sortByKey()","text":"%pyspark\n\nrdd.sortByKey(ascending=False).collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(3, 4), (3, 6), (1, 2), (1, 5)]\n"}]},"apps":[],"jobName":"paragraph_1637854886166_573273507","id":"20210625-161343_751679855","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17438"},{"title":"subtractByKey()","text":"%pyspark\n\nrdd2=sc.parallelize([(1,9)])\n\nrdd.subtractByKey(rdd2).collect()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(3, 4), (3, 6)]\n"}]},"apps":[],"jobName":"paragraph_1637854886167_841492702","id":"20210625-161342_662995925","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17439"},{"title":"countByKey","text":"%pyspark\n\nrdd.countByKey().items()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 2), (3, 2)]\n"}]},"apps":[],"jobName":"paragraph_1637854886168_801253776","id":"20210625-162531_113910201","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17440"},{"title":"join()","text":"%pyspark\n\nrdd.join(rdd2).collect()\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, (2, 9)), (1, (5, 9))]\n"}]},"apps":[],"jobName":"paragraph_1637854886170_-434964798","id":"20210625-161342_28891078","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17441"},{"text":"%md\n\n# RDD Actions\n\ncollect()\ntake()\ncount()\ntop()\nreduce()\nfirst()\nsum()\naggregate()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>RDD Actions</h1>\n<p>collect()\n<br  />take()\n<br  />count()\n<br  />top()\n<br  />reduce()\n<br  />first()\n<br  />sum()\n<br  />aggregate()</p>\n"}]},"apps":[],"jobName":"paragraph_1637854886171_-335138187","id":"20210625-161330_161132760","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17442"},{"title":"collect()","text":"%pyspark\n\nrdd = sc.parallelize([2, 2, 3, 5, 6, 6, 7, 8, 9, 0])\n\nrdd.collect()\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[2, 2, 3, 5, 6, 6, 7, 8, 9, 0]\n"}]},"apps":[],"jobName":"paragraph_1637854886172_-926626990","id":"20210625-162745_83801223","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17443"},{"text":"%pyspark\n\nnew_rdd=sc.parallelize([1, 2, 3, 4])\n\nnew_rdd.aggregate((0, 0), \n    (lambda x, y:(x[0] + y, x[1] + 1)), \n    (lambda x, y:(x[0] + y[0], x[1] + y[1])) )\n","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(10, 4)\n"}]},"apps":[],"jobName":"paragraph_1637854886173_947102060","id":"20210625-162822_205659926","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17444"},{"text":"%pyspark\n\n# In Python\n# Create an RDD of tuples (name, age)\n\ndataRDD = sc.parallelize(\n    [(\"Brooke\", 20), (\"Denny\", 31), (\"Jules\", 30), (\"TD\", 35), (\"Brooke\", 25)]\n    )\n\n# Use map and reduceByKey transformations with their lambda\n# expressions to aggregate and then compute average\n\nagesRDD = (dataRDD\n.map(lambda x: (x[0], (x[1], 1)))\n.reduceByKey(lambda x, y: (x[0] + y[0], x[1] + y[1]))\n.map(lambda x: (x[0], x[1][0] / x[1][1])))\n\nagesRDD.take(10)","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Jules', 30), ('Brooke', 22), ('TD', 35), ('Denny', 31)]\n"}]},"apps":[],"jobName":"paragraph_1637854886174_-1418672975","id":"20210625-165909_151031700","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17445"},{"text":"%pyspark\n\ndataRDD\\\n.map(lambda x: (x[0], (x[1], 1))) \\\n.reduceByKey(lambda x, y: (x[0] + y[0], x[1] + y[1])).take(10)","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('Jules', (30, 1)), ('Brooke', (45, 2)), ('TD', (35, 1)), ('Denny', (31, 1))]\n"}]},"apps":[],"jobName":"paragraph_1637854886175_-661241516","id":"20210625-182325_279082711","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17446"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import avg\n\ndata_df = spark.createDataFrame([(\"Brooke\", 20), (\"Denny\", 31), (\"Jules\", 30),\n(\"TD\", 35), (\"Brooke\", 25)], [\"name\", \"age\"])\n\n# Group the same names together, aggregate their ages, and compute an average\navg_df = data_df.groupBy(\"name\").agg(avg(\"age\"))\n\navg_df.show()","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------+\n|  name|avg(age)|\n+------+--------+\n|Brooke|    22.5|\n| Jules|    30.0|\n|    TD|    35.0|\n| Denny|    31.0|\n+------+--------+\n\n"}]},"apps":[],"jobName":"paragraph_1637854886176_1861411875","id":"20210625-162745_2016842150","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17447"},{"title":"Broadcast read-only Variables","text":"%pyspark\n\nstates = {\"NY\":\"New York\", \"CA\":\"California\", \"FL\":\"Florida\"}\nbroadcastStates = spark.sparkContext.broadcast(states)\n\ndata = [(\"James\",\"Smith\",\"USA\",\"CA\"),\n    (\"Michael\",\"Rose\",\"USA\",\"NY\"),\n    (\"Robert\",\"Williams\",\"USA\",\"CA\"),\n    (\"Maria\",\"Jones\",\"USA\",\"FL\")\n  ]\n\ncolumns = [\"firstname\",\"lastname\",\"country\",\"state\"]\ndf = spark.createDataFrame(data = data, schema = columns)\ndf.printSchema()\ndf.show(truncate=False)\n\ndef state_convert(code):\n    return broadcastStates.value[code]\n\nresult = df.rdd.map(lambda x: (x[0],x[1],x[2],state_convert(x[3]))).toDF(columns)\nresult.show(truncate=False)","user":"admin","dateUpdated":"2021-11-29T18:17:11+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- firstname: string (nullable = true)\n |-- lastname: string (nullable = true)\n |-- country: string (nullable = true)\n |-- state: string (nullable = true)\n\n+---------+--------+-------+-----+\n|firstname|lastname|country|state|\n+---------+--------+-------+-----+\n|James    |Smith   |USA    |CA   |\n|Michael  |Rose    |USA    |NY   |\n|Robert   |Williams|USA    |CA   |\n|Maria    |Jones   |USA    |FL   |\n+---------+--------+-------+-----+\n\n+---------+--------+-------+----------+\n|firstname|lastname|country|state     |\n+---------+--------+-------+----------+\n|James    |Smith   |USA    |California|\n|Michael  |Rose    |USA    |New York  |\n|Robert   |Williams|USA    |California|\n|Maria    |Jones   |USA    |Florida   |\n+---------+--------+-------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1638199011588_-1007173991","id":"20211129-181651_1460607340","dateCreated":"2021-11-29T18:16:51+0300","dateStarted":"2021-11-29T18:17:02+0300","dateFinished":"2021-11-29T18:17:24+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17448"},{"title":"PySpark Accumulator","text":"%pyspark\n\naccum=spark.sparkContext.accumulator(0)\nrdd=spark.sparkContext.parallelize([1,2,3,4,5])\nrdd.foreach(lambda x:accum.add(x))\nprint(accum.value)\n\naccuSum=spark.sparkContext.accumulator(0)\ndef countFun(x):\n    global accuSum\n    accuSum+=x\nrdd.foreach(countFun)\nprint(accuSum.value)\n\naccumCount=spark.sparkContext.accumulator(0)\nrdd2=spark.sparkContext.parallelize([1,2,3,4,5])\nrdd2.foreach(lambda x:accumCount.add(1))\nprint(accumCount.value)","user":"admin","dateUpdated":"2021-11-29T18:23:55+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"15\n15\n5\n"}]},"apps":[],"jobName":"paragraph_1638199411807_1304155595","id":"20211129-182331_329969174","dateCreated":"2021-11-29T18:23:31+0300","dateStarted":"2021-11-29T18:23:34+0300","dateFinished":"2021-11-29T18:23:35+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17449"},{"text":"%pyspark\nsc.applicationId","user":"admin","dateUpdated":"2021-11-29T18:24:01+0300","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'application_1637409254228_0508'\n"}]},"apps":[],"jobName":"paragraph_1638199435899_-1206194895","id":"20211129-182355_40053074","dateCreated":"2021-11-29T18:23:55+0300","dateStarted":"2021-11-29T18:24:01+0300","dateFinished":"2021-11-29T18:24:01+0300","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17450"},{"text":"%md\n# ДЗ","user":"admin","dateUpdated":"2021-11-25T18:41:26+0300","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>ДЗ</h1>\n"}]},"apps":[],"jobName":"paragraph_1637854886177_-1134947020","id":"20210625-162745_67533518","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17451"},{"title":"Сгруппировать по ключу, просуммировать значения, вывести результат","text":"%pyspark\n\nrdd = sc.parallelize([(1,2), (3,4), (3,6), (4,5), (3, 4), (1, 5), (4, 1)])\n","user":"admin","dateUpdated":"2021-11-29T18:53:44+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637854886179_2125691181","id":"20210625-162744_1021107512","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17452"},{"title":"Word count","text":"%pyspark\n\nlines = sc.parallelize([\n    \"a ab abc\",\n    \"a ac abc\",\n    \"b b ab abc\"\n    ])\n\ncounts = lines.flatMap(lambda x: x.split(' ')) \\\n# дополнить код, чтобы получился rdd из пар (слово, частота)\n\noutput = counts.collect()\n\nfor (word, count) in output:\n    print(\"%s: %i\" % (word, count))","user":"admin","dateUpdated":"2021-11-29T20:32:47+0300","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1637854886178_782772951","id":"20210625-165626_1100932547","dateCreated":"2021-11-25T18:41:26+0300","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17453"}],"name":"it_3/5 lecture","id":"2GNHV9G9B","noteParams":{},"noteForms":{},"angularObjects":{"sparkLocal:shared_process":[],"md:shared_process":[],"python:shared_process":[],"sh:shared_process":[],"spark::2GNHV9G9B":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}